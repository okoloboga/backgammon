# –≠—Ç–∞–ø 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–º–∞—Ä—Ç–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞

## üéØ –¶–µ–ª—å
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Escrow –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ç–∞–≤–æ–∫ –≤ TON –∏ RUBLE. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã–ø–ª–∞—Ç—ã –ø–æ–±–µ–¥–∏—Ç–µ–ª—è–º.

**–ü—Ä–µ–¥—É—Å–ª–æ–≤–∏–µ**: –≠—Ç–∞–ø 1 –∑–∞–≤–µ—Ä—à–µ–Ω, –∏–≥—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ mock-—Ä–µ–∂–∏–º–µ.

---

## üìã –ó–∞–¥–∞—á–∏

### 2.1 –î–µ–ø–ª–æ–π Escrow –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞

**–ß—Ç–æ –¥–µ–ª–∞–µ–º**:
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –≤ TON testnet
- –î–µ–ø–ª–æ–π –≤ mainnet —á–µ—Ä–µ–∑ `deployEscrow.ts`
- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
- –°–æ–∑–¥–∞–Ω–∏–µ admin –∫–æ—à–µ–ª—å–∫–∞ (–æ—Ç–¥–µ–ª—å–Ω—ã–π –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
- –°–æ–∑–¥–∞–Ω–∏–µ fee wallet (–∫—É–¥–∞ –∏–¥—É—Ç –∫–æ–º–∏—Å—Å–∏–∏ 5% –æ—Ç TON –∏–≥—Ä)
- –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ admin –∫–æ—à–µ–ª—å–∫–∞ –¥–ª—è –≥–∞–∑–∞
- –¢–µ—Å—Ç–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (CreateGameTon, JoinGameTon, ReportWinner, ClaimJetton)
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∞–¥—Ä–µ—Å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** (.env):
- `TON_ESCROW_ADDRESS`
- `TON_ADMIN_MNEMONIC`
- `RUBLE_JETTON_MASTER`
- `MIN_TON_BET=1`
- `MIN_RUBLE_BET=1000`
- `TON_FEE_PERCENT=5`

**–ö—Ä–∏—Ç–µ—Ä–∏–π**: –ö–æ–Ω—Ç—Ä–∞–∫—Ç –∑–∞–¥–µ–ø–ª–æ–µ–Ω, —Ç–µ—Å—Ç–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç

---

### 2.2 Backend: EscrowService

**–°–æ–∑–¥–∞—Ç—å**: `ton/escrow.service.ts`

**–ú–µ—Ç–æ–¥—ã**:
- `getContractAddress()` - –∞–¥—Ä–µ—Å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
- `createGameTon(walletAddress, amount)` - —Å–æ–∑–¥–∞–Ω–∏–µ TON –∏–≥—Ä—ã
- `createGameJetton(walletAddress, jettonMaster, amount)` - —Å–æ–∑–¥–∞–Ω–∏–µ Jetton –∏–≥—Ä—ã
- `joinGameTon(walletAddress, gameId, amount)` - –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ TON –∏–≥—Ä–µ
- `joinGameJetton(walletAddress, gameId)` - –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ Jetton –∏–≥—Ä–µ
- `reportWinner(gameId, winnerAddress)` - –≤—ã–∑–æ–≤ ReportWinner –æ—Ç –∞–¥–º–∏–Ω–∞
- `cancelGame(gameId, creatorAddress)` - –æ—Ç–º–µ–Ω–∞ –∏–≥—Ä—ã
- `getGameState(gameId)` - –ø–æ–ª—É—á–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã –∏–∑ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞

**–õ–æ–≥–∏–∫–∞**:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç TON SDK –¥–ª—è –≤—ã–∑–æ–≤–æ–≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç admin –º–Ω–µ–º–æ–Ω–∏–∫—É –¥–ª—è ReportWinner
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (retry –¥–æ 3 —Ä–∞–∑)
- –õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**–ö—Ä–∏—Ç–µ—Ä–∏–π**: –ú–µ—Ç–æ–¥—ã –≤—ã–∑—ã–≤–∞—é—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç

---

### 2.3 Backend: RoomsModule

**–°–æ–∑–¥–∞—Ç—å**: `rooms/rooms.module.ts`, `rooms.service.ts`, `rooms.controller.ts`

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã**:

**POST /rooms/create**:
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: currency (TON/RUBLE), amount, walletAddress
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –±–∞–ª–∞–Ω—Å (—á–µ—Ä–µ–∑ TonService)
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Å—Ç–∞–≤–∫—É
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π gameId
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ë–î (state = waiting)
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: roomId, gameId

**POST /rooms/:roomId/join**:
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: walletAddress
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –∫–æ–º–Ω–∞—Ç–∞ waiting
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –Ω–µ —Å–æ–∑–¥–∞—Ç–µ–ª—å
- –û–±–Ω–æ–≤–ª—è–µ—Ç –ë–î (state = in_progress, joiner_address)
- –ò–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ Colyseus Room
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: roomId, sessionId

**POST /rooms/:roomId/verify-create**:
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: txHash
- –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é CreateGameTon —á–µ—Ä–µ–∑ EscrowService
- –û–±–Ω–æ–≤–ª—è–µ—Ç –ë–î (tx_hash)

**POST /rooms/:roomId/verify-join**:
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: txHash
- –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é JoinGameTon
- –û–±–Ω–æ–≤–ª—è–µ—Ç –ë–î

**DELETE /rooms/:roomId/cancel**:
- –í—ã–∑—ã–≤–∞–µ—Ç EscrowService.cancelGame
- –û–±–Ω–æ–≤–ª—è–µ—Ç –ë–î (state = cancelled)

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `rooms`**:
- –î–æ–±–∞–≤–∏—Ç—å: `tx_hash` (VARCHAR) - —Ö–µ—à —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è
- –î–æ–±–∞–≤–∏—Ç—å: `join_tx_hash` (VARCHAR) - —Ö–µ—à —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –î–æ–±–∞–≤–∏—Ç—å: `winner_tx_hash` (VARCHAR) - —Ö–µ—à –≤—ã–ø–ª–∞—Ç—ã

**–ö—Ä–∏—Ç–µ—Ä–∏–π**: API —Å–æ–∑–¥–∞–µ—Ç –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–º–Ω–∞—Ç—ã, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ö–µ—à–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

---

### 2.4 Frontend: TonTransactionService

**–°–æ–∑–¥–∞—Ç—å**: `services/tonTransactionService.js`

**–ú–µ—Ç–æ–¥—ã**:
- `createGameTon(amount)` - –æ—Ç–ø—Ä–∞–≤–∫–∞ CreateGameTon —á–µ—Ä–µ–∑ TonConnect
- `createGameRuble(amount)` - –æ—Ç–ø—Ä–∞–≤–∫–∞ Jetton transfer —Å payload action=0
- `joinGameTon(gameId, amount)` - –æ—Ç–ø—Ä–∞–≤–∫–∞ JoinGameTon
- `joinGameRuble(gameId, amount)` - –æ—Ç–ø—Ä–∞–≤–∫–∞ Jetton transfer —Å payload action=1
- `claimJettonWinnings(gameId)` - –≤—ã–∑–æ–≤ ClaimJetton
- `waitForConfirmation(txHash)` - polling –¥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- `buildJettonPayload(action, gameId)` - –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ payload

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç**:
- `tonConnectUI.sendTransaction()` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
- TonCenter API –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

**–ö—Ä–∏—Ç–µ—Ä–∏–π**: –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Å—Ç–∞—Ç—É—Å

---

### 2.5 Frontend: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ CreateRoomModal

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:

**–§–ª–∞–≥ —Ä–µ–∂–∏–º–∞**: –ß–µ–∫–±–æ–∫—Å "Test mode (no real transactions)" –≤ dev-—Ä–µ–∂–∏–º–µ

**–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–º–Ω–∞—Ç—ã**:

**Mock-—Ä–µ–∂–∏–º** (–µ—Å–ª–∏ —Ñ–ª–∞–≥ –≤–∫–ª—é—á–µ–Ω):
- –°—Ä–∞–∑—É –≤—ã–∑–≤–∞—Ç—å `POST /rooms/create`
- –ü–µ—Ä–µ–π—Ç–∏ –≤ GameRoom

**Real-—Ä–µ–∂–∏–º** (–µ—Å–ª–∏ —Ñ–ª–∞–≥ –≤—ã–∫–ª—é—á–µ–Ω):
1. –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "Signing transaction..."
2. –í—ã–∑–≤–∞—Ç—å `tonTransactionService.createGameTon/Ruble(amount)`
3. –ü–æ–∫–∞–∑–∞—Ç—å "Waiting for confirmation..."
4. –î–æ–∂–¥–∞—Ç—å—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
5. –í—ã–∑–≤–∞—Ç—å `POST /rooms/:roomId/verify-create` —Å txHash
6. –í—ã–∑–≤–∞—Ç—å `POST /rooms/create`
7. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Colyseus
8. –ü–µ—Ä–µ–π—Ç–∏ –≤ GameRoom

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫–ª–æ–Ω–∏–ª ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å "Transaction cancelled"
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–∞–ª–∞–Ω—Å–∞ ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å "Insufficient balance"
- –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É

**–ö—Ä–∏—Ç–µ—Ä–∏–π**: –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É –≤ –æ–±–æ–∏—Ö —Ä–µ–∂–∏–º–∞—Ö

---

### 2.6 Frontend: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ RoomList

**–ü—Ä–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏ –∫ –∫–æ–º–Ω–∞—Ç–µ**:

**Mock-—Ä–µ–∂–∏–º**:
- –í—ã–∑–≤–∞—Ç—å `POST /rooms/:roomId/join`
- –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Colyseus
- –ü–µ—Ä–µ–π—Ç–∏ –≤ GameRoom

**Real-—Ä–µ–∂–∏–º**:
1. –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª–∫—É –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç–∞–≤–∫–µ)
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å
3. –í—ã–∑–≤–∞—Ç—å `tonTransactionService.joinGameTon/Ruble()`
4. –î–æ–∂–¥–∞—Ç—å—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
5. –í—ã–∑–≤–∞—Ç—å `POST /rooms/:roomId/verify-join`
6. –í—ã–∑–≤–∞—Ç—å `POST /rooms/:roomId/join`
7. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Colyseus
8. –ü–µ—Ä–µ–π—Ç–∏ –≤ GameRoom

**–û–±—Ä–∞–±–æ—Ç–∫–∞**:
- –ö–æ–º–Ω–∞—Ç–∞ —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å "Room is full"
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–∞–ª–∞–Ω—Å–∞ ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É

**–ö—Ä–∏—Ç–µ—Ä–∏–π**: –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ–±–æ–∏—Ö —Ä–µ–∂–∏–º–∞—Ö

---

### 2.7 Backend: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã —Å ReportWinner

**–û–±–Ω–æ–≤–∏—Ç—å**: `BackgammonRoom.declareWinner()`

**–õ–æ–≥–∏–∫–∞**:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å winner –≤ state
2. –û–±–Ω–æ–≤–∏—Ç—å –ë–î (state = finished, winner_address)
3. **–ï—Å–ª–∏ Real-—Ä–µ–∂–∏–º**:
   - –í—ã–∑–≤–∞—Ç—å `EscrowService.reportWinner(gameId, winnerAddress)`
   - –î–æ–∂–¥–∞—Ç—å—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (—Å retry)
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å `winner_tx_hash` –≤ –ë–î
4. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–≥—Ä–æ–∫–æ–≤
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ `game_history`
6. –û—Ç–ø—Ä–∞–≤–∏—Ç—å `game_finished` –∫–ª–∏–µ–Ω—Ç–∞–º:
   - winner, loser, reason
   - txHash (–µ—Å–ª–∏ real-—Ä–µ–∂–∏–º)
   - winnings (—Å—É–º–º–∞)
7. –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**:
- ReportWinner –Ω–µ –ø—Ä–æ—à–µ–ª ‚Üí retry 3 —Ä–∞–∑–∞
- –ï—Å–ª–∏ –Ω–µ –ø—Ä–æ—à–ª–æ ‚Üí –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å, —É–≤–µ–¥–æ–º–∏—Ç—å –∞–¥–º–∏–Ω–∞, –æ—Å—Ç–∞–≤–∏—Ç—å flag `payout_pending`

**–ö—Ä–∏—Ç–µ—Ä–∏–π**: –í—ã–ø–ª–∞—Ç–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è (TON) –∏–ª–∏ –≥–æ—Ç–æ–≤–∞ –∫ Claim (RUBLE)

---

### 2.8 Frontend: –≠–∫—Ä–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)

**–î–æ–±–∞–≤–∏—Ç—å –¥–ª—è Real-—Ä–µ–∂–∏–º–∞**:

**–î–ª—è TON –∏–≥—Ä**:
- –ü–æ–∫–∞–∑–∞—Ç—å —Å—É–º–º—É –≤—ã–∏–≥—Ä—ã—à–∞ (—Å —É—á–µ—Ç–æ–º 5% –∫–æ–º–∏—Å—Å–∏–∏)
- –°—Å—ã–ª–∫–∞ –Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ TON Explorer

**–î–ª—è RUBLE –∏–≥—Ä**:
- –ö–Ω–æ–ø–∫–∞ "Claim Winnings" (–¥–ª—è –ø–æ–±–µ–¥–∏—Ç–µ–ª—è)
- –ü—Ä–∏ –∫–ª–∏–∫–µ:
  - –í—ã–∑–≤–∞—Ç—å `tonTransactionService.claimJettonWinnings(gameId)`
  - –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
  - –ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è - –ø–æ–∫–∞–∑–∞—Ç—å —É—Å–ø–µ—Ö
  - –û–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å

**–ö—Ä–∏—Ç–µ—Ä–∏–π**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –≤—ã–∏–≥—Ä—ã—à –∏ –º–æ–∂–µ—Ç –∑–∞–±—Ä–∞—Ç—å –µ–≥–æ (RUBLE)

---

### 2.9 Backend: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞

**–°–æ–∑–¥–∞—Ç—å**: `ton/contract-monitor.service.ts`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**:
- –§–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å (–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
- –ö–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥:
  - –ü–æ–ª—É—á–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
  - –ü–∞—Ä—Å–∏—Ç—å —Å–æ–±—ã—Ç–∏—è
  - –°–≤–µ—Ä—è—Ç—å —Å —Ç–∞–±–ª–∏—Ü–µ–π `rooms`
  - –ï—Å–ª–∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ ‚Üí –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å, —É–≤–µ–¥–æ–º–∏—Ç—å –∞–¥–º–∏–Ω–∞
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –≤ `blockchain_events`

**–¢–∞–±–ª–∏—Ü–∞ `blockchain_events`**:
- id, tx_hash (UNIQUE), event_type
- game_id, data (JSONB)
- timestamp, processed

**–ö—Ä–∏—Ç–µ—Ä–∏–π**: –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –º–µ–∂–¥—É –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–º –∏ –ë–î –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è

---

### 2.10 –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–µ–∂–∏–º–æ–≤

**Backend**: –§–ª–∞–≥ `USE_MOCK_TRANSACTIONS` –≤ .env

**–õ–æ–≥–∏–∫–∞**:
- –ï—Å–ª–∏ true:
  - –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –≤—ã–∑–æ–≤–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
  - –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è fake gameId
- –ï—Å–ª–∏ false:
  - –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–º
  - –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

**Frontend**: –ß–µ–∫–±–æ–∫—Å "Test mode" –≤ CreateRoomModal (—Ç–æ–ª—å–∫–æ –≤ dev)

**–ö—Ä–∏—Ç–µ—Ä–∏–π**: –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –º–æ–∫–∞–º–∏ –∏ —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏

---

### 2.11 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**Testnet**:
- –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã TON
- –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã RUBLE
- –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–∞–º
- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã, –≤—ã–ø–ª–∞—Ç–∞ TON
- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã, Claim RUBLE
- –û—Ç–º–µ–Ω–∞ –∫–æ–º–Ω–∞—Ç—ã, refund

**Mainnet** (–º–∞–ª—ã–µ —Å—É–º–º—ã):
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ —Å—Ç–∞–≤–∫–∞–º–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–ª–∞—Ç

**–ö—Ä–∏—Ç–µ—Ä–∏–π**: –í—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç, –≤—ã–ø–ª–∞—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–∞–ø–∞

- ‚úÖ Escrow –∫–æ–Ω—Ç—Ä–∞–∫—Ç –∑–∞–¥–µ–ø–ª–æ–µ–Ω –≤ mainnet
- ‚úÖ EscrowService –≤—ã–∑—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥—ã –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã —á–µ—Ä–µ–∑ TON —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã —á–µ—Ä–µ–∑ RUBLE —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
- ‚úÖ –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤—ã–ø–ª–∞—Ç–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—é (TON)
- ‚úÖ Claim –¥–ª—è RUBLE –∏–≥—Ä
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ mock/real —Ä–µ–∂–∏–º–æ–≤
- ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ testnet –∏ mainnet

---

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–∞–ø–∞ 2:
- –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –∏–≥—Ä–∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–µ–Ω—å–≥–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã–ø–ª–∞—Ç—ã
- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (post-MVP)

- –ü—Ä–æ—Ñ–∏–ª—å —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –ø–∞—Ä—Ç–∏–π
- Leaderboard
- –¢—É—Ä–Ω–∏—Ä—ã
- –£–ª—É—á—à–µ–Ω–∏—è UI/UX
- –î–µ–ø–ª–æ–π –≤ production

